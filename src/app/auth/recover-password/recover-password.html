<div class="forgot-password-container">
  <div class="forgot-password-card">

    <div class="forgot-password-header">
        <div class="icon-wrapper">
          <svg class="lock-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18 8H17V6C17 3.24 14.76 1 12 1C9.24 1 7 3.24 7 6V8H6C4.9 8 4 8.9 4 10V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V10C20 8.9 19.1 8 18 8ZM12 17C10.9 17 10 16.1 10 15C10 13.9 10.9 13 12 13C13.1 13 14 13.9 14 15C14 16.1 13.1 17 12 17ZM15.1 8H8.9V6C8.9 4.29 10.29 2.9 12 2.9C13.71 2.9 15.1 4.29 15.1 6V8Z" fill="currentColor"/>
          </svg>
        </div>
        <h1 class="forgot-password-title">{{ 'forgotPassword.title' | transloco }}</h1>
        <p class="forgot-password-subtitle">{{ 'forgotPassword.subtitle' | transloco }}</p>
      </div>



      <!-- Formulario -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-password-form" novalidate>

        <!-- Campo de número de identificación -->
        <div class="form-group">
          <label for="identificationNumber" class="form-label">
            {{ 'forgotPassword.form.identification' | transloco }}
            <span class="required">*</span>
          </label>
          <div class="input-wrapper">

            <input
              id="identificationNumber"
              type="text"
              formControlName="identificationNumber"
              class="form-input form-input--with-icon"
              [class.form-input--error]="hasError('identificationNumber')"
              [placeholder]="'forgotPassword.form.identificationPlaceholder' | transloco"
              (input)="clearError()"
              autocomplete="off"
              inputmode="numeric"
            />
          </div>
          @if (hasError('identificationNumber')) {
            <span class="form-error">
              {{ getErrorMessage('identificationNumber') | transloco }}
            </span>
          }
        </div>

        <!-- Campo de usuario -->
        <div class="form-group">
          <label for="username" class="form-label">
            {{ 'forgotPassword.form.username' | transloco }}
            <span class="required">*</span>
          </label>
          <div class="input-wrapper">

            <input
              id="username"
              type="text"
              formControlName="username"
              class="form-input form-input--with-icon"
              [class.form-input--error]="hasError('username')"
              [placeholder]="'forgotPassword.form.usernamePlaceholder' | transloco"
              (input)="clearError()"
              autocomplete="username"
            />
          </div>
          @if (hasError('username')) {
            <span class="form-error">
              {{ getErrorMessage('username') | transloco }}
            </span>
          }
        </div>

        <!-- Dropdown de colegio -->
        <div class="form-group">
          <label for="school" class="form-label">
            {{ 'forgotPassword.form.school' | transloco }}
            <span class="required">*</span>
          </label>
          <div class="select-wrapper">
            <select
              id="school"
              formControlName="school"
              class="form-select"
              [class.form-select--error]="hasError('school')"
              (change)="clearError()"
            >
              <option value="" disabled>{{ 'forgotPassword.form.selectSchool' | transloco }}</option>
              @for (school of schools; track trackByValue($index, school)) {
                <option [value]="school.value">
                  {{ school.icon }} {{ school.labelKey | transloco }}
                </option>
              }
            </select>
            <svg class="select-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          @if (hasError('school')) {
            <span class="form-error">
              {{ getErrorMessage('school') | transloco }}
            </span>
          }
        </div>

        <!-- Información del colegio seleccionado -->
        @if (getSelectedSchool()) {
          <div class="method-info">
            <div class="method-info-icon">{{ getSelectedSchool()?.icon }}</div>
            <p class="method-info-text">
              {{ 'forgotPassword.schoolInfo.' + getSelectedSchool()?.value | transloco }}
            </p>
          </div>
        }

        <!-- Botones de acción -->
        <div class="form-actions">
          <button
            type="submit"
            class="btn btn--primary"
            [class.btn--loading]="isLoading()"
            [disabled]="isLoading()"
          >
            @if (isLoading()) {
              <span class="spinner"></span>
              {{ 'forgotPassword.form.sending' | transloco }}
            } @else {
              {{ 'forgotPassword.form.submit' | transloco }}
            }
          </button>

          <button
            type="button"
            class="btn btn--secondary"
            (click)="goToLogin()"
            [disabled]="isLoading()"
          >
            {{ 'forgotPassword.form.backToLogin' | transloco }}
          </button>
        </div>
      </form>


  </div>
</div>
